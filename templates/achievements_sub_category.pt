<div metal:use-macro="layout">
    <style type="text/css" media="screen" metal:fill-slot="css">
        .achievement_row
        {
            border-bottom: 1px dotted #AAA;
            padding: 12px;
            margin: 5px;
            clear: both;
            min-height: 75px;
        }
        
        .achievement_thumb
        {
            float: left;
            margin-right: 10px;
        }
    </style>
    
    <div metal:fill-slot="header_buttons" style="display:inline-block;">
        
    </div>
    
    <div metal:fill-slot="content">
        <div class="error">
            This is still a work in progress. As with Wordy I am writing this my free time. If you have any suggestions then please let me know.
        </div>
        
        <h3>${category['name']}: ${sub_category['name']}</h3>
       <div tal:repeat="a achievement_list" class="achievement_row">
            <div tal:define="a_type achievement_types[a]; a_item player_achievements.get(a, None)">
                
                <!-- No achievement -->
                <div tal:condition="a_item == None">
                    <script type="text/javascript">
                        $(function() {$("#${a_type.lookup}").progressbar({max:100,value:0});});
                    </script>
                    
                    <img src="${request.static_url('dashboard:static/images/achievements/{}_thumb.png'.format(a_type.lookup))}" width="75" height="75" class="achievement_thumb" />
                    <strong>${a_type.name} - 0/${a_type.activation_count}</strong><br />
                    ${a_type.description}
                    <div id="${a_type.lookup}" style="margin-left:85px;">
                        &nbsp;
                    </div>
                </div>
                
                <!-- Partial -->
                <div tal:condition="a_type.id in player_achievements and (player_achievements[a_type.id].activation_count < a_type.activation_count)">
                    <script type="text/javascript">
                        $(function() {$("#${a_type.lookup}").progressbar({max:${a_type.activation_count},value:${player_achievements[a_type.id].activation_count}});});
                    </script>
                    
                    <img src="${request.static_url('dashboard:static/images/achievements/{}_thumb.png'.format(a_type.lookup))}" width="75" height="75" class="achievement_thumb" />
                    <strong>${a_type.name} - ${player_achievements[a_type.id].activation_count}/${a_type.activation_count}</strong><br />
                    ${a_type.description}
                    <div id="${a_type.lookup}" style="margin-left:85px;">
                        &nbsp;
                    </div>
                </div>
                
                <div tal:condition="a_type.id in player_achievements and (player_achievements[a_type.id].activation_count >= a_type.activation_count)">
                    <script type="text/javascript">
                        $(function() {$("#${a_type.lookup}").progressbar({max:100,value:100});});
                    </script>
                    
                    <img src="${request.static_url('dashboard:static/images/achievements/{}_thumb.png'.format(a_type.lookup))}" width="75" height="75" class="achievement_thumb" />
                    <strong>${a_type.name} - Completed</strong><br />
                    ${a_type.description}
                    <div id="${a_type.lookup}" style="margin-left:85px;">
                        &nbsp;
                    </div>
                </div>
            </div>
        </div>
        
        <br /><br />
        <a href="${request.route_url('achievements_category', user_id=user_id, category=request.matchdict['category'])}" class="button">${category['name']} achievements section</a>
        <a href="${request.route_url('user_achievements', user_id=user_id)}" class="button">Achievements home</a>
    </div>
</div>